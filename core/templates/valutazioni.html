{% extends 'base.html' %}
{% load core_extras %}
{% load crispy_forms_tags %}

{% block title %} Valutazioni {% endblock %}



{% block extrahead %}

<style>
    .asteriskField {
        display: none;
    }

    .fixed { position: fixed; top: 50px; }

    html, body { 
        margin: 0px; 
        padding: 0px;
        height: 100%;
    }

    iframe {
        display: block;
        height: 100%;
        width: 100%;
        border: none;
    }

    .content {
        height: 100%;
    }

    .container-fluid {
        height: 100%;
    }
</style>


<script type="text/javascript">
    $('#tabs a').click(function (e) {
      e.preventDefault();
      $(this).tab('show');
    })

    $(function() {
        var fixadent = $("#fixadent"), pos = fixadent.offset();
        $(window).scroll(function() {
        if($(this).scrollTop() > (pos.top + 10) && fixadent.css('position') == 'static') { fixadent.addClass('fixed'); }
        else if($(this).scrollTop() <= pos.top && fixadent.hasClass('fixed')){ fixadent.removeClass('fixed'); }
        })
    });
</script>

{% endblock %}

{% block content_fluid %}

{% for url in url_list %}
    <div class="row-fluid" style="text-align:center; border-bottom: 1px solid #eee; margin-top: 40px;">
        <div class="span12">
            <a target="_blank" href="{{ url }}"><h2><i class="icon-link"></i> {{ url }}</h2></a>
        </div>
        {% for message in messages %}
            <div class="span8 offset2">
                <p class="alert alert-{{ message.tags }}" style="text-align: center;">
                    {% ifequal message.tags 'success' %} <i class="icon-ok"></i>{% endifequal %}
                    {% ifequal message.tags 'info' %} <i class="icon-info-sign"></i>{% endifequal %}
                    {{ message }}
                </p>
            </div>
        {% endfor %}
    </div>

    <div class="row-fluid" style="height: 100%;">
        <div class="span3" style="margin-top:20px; border-right: 1px solid #eee; padding-right: 15px">  
          <ul id="tabs" class="nav nav-tabs" data-tabs="tabs">
            <li class="active"><a href="#valuta" data-toggle="tab">Valuta</a></li>
            <li><a href="#conferma" data-toggle="tab">Conferma</a></li>
            <li><a href="#ripensa" data-toggle="tab">Ritorna</a></li>
          </ul>
          <div class="tab-content">
            <div class="tab-pane fade in active" id="valuta">
                <p>
                    Quali sono la rilevanza e la qualit√† della pagina web presentata qui 
                    sotto, rispetto all'interrogazione da voi scelta ({{ interrogazione }})? 
                    Esprimete le vostre valutazioni inserendo un voto da 1 (pessimo)
                    a 5 (ottimo) per ciascun punto presente nella lista.
                </p>
            </div>
            <div class="tab-pane fade" id="conferma">
              <p>
                Una volta terminata la valutazione di questa pagina,
                ricordatevi di cliccare su 'Conferma Voto' per inserire i vostri
                voti; cliccate invece su 'successivo' se desiderate valutare
                un'altra pagina senza inserire i vostri voti per questa.
              </p>
            </div>

            <div class="tab-pane fade" id="ripensa">
              <p>
                In caso di ripensamenti, potrete sempre modificare le vostre
                valutazioni ritornando sui vostri passi.
              </p>
            </div>
          </div>
        
            <div class="pagination pagination-centered">
                <ul>
                    {% if url_list.has_previous %}
                        <li><a href="?page={{ url_list.previous_page_number }}"><i class=" icon-arrow-left"></i></a></li>
                    {% endif %}
                        <li><a href="#">pagina {{ url_list.number }} di {{ url_list.paginator.num_pages }}</a></li>
                    {% if url_list.has_next %}
                        <li><a href="?page={{ url_list.next_page_number }}"><i class="icon-arrow-right"></i></a></li>
                    {% endif %}
                </ul>
            </div>

            <div id="fixadent">
            <form action="{% url 'votazioni' interrogazione.pk url.pk %}?page={% if url_list.has_next %}{{ url_list.next_page_number }}{% else %}{{ url_list.number }}{% endif %}" method="POST">{% csrf_token %}
                {% crispy formset formset.form.helper %}
            </form> 
            </div>
        </div>

        <div class="span9" style="margin-top: 20px; height:100%;">
            {% if url.percorso_su_disco %}
                <iframe id="qualita-frame" name="qualita-frame" src="{{ MEDIA_URL }}{{ url.get_percorso }}" height="100%" width="100%"></iframe>
            {% else %}
                <iframe id="qualita-frame" name="qualita-frame" src="{{ url }}" frameborder="0" height="100%" width="100%"></iframe>
            {% endif %}
        </div>
    </div>

{% endfor %}

{% endblock %}